<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFCä¸€é”®åˆ†äº«ä¸­æ¢</title>
    <!-- å¼•å…¥æŠ–éŸ³å®˜æ–¹Web SDK -->
    <script src="https://s3.pstatp.com/toutiao/open-platform/sdk.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'PingFang SC', sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); text-align: center; max-width: 400px; width: 100%; }
        
        .share-btn { 
            width: 100%; padding: 18px; margin: 12px 0; border: none; border-radius: 12px; 
            font-size: 17px; font-weight: 600; cursor: pointer; color: white; transition: all 0.3s;
        }
        .share-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        #btn-douyin { background: linear-gradient(45deg, #000000, #FE2C55); }
        #btn-kuaishou { background: linear-gradient(45deg, #FF0000, #FF9000); }
        
        .status-box { margin: 20px 0; padding: 15px; border-radius: 12px; display: none; }
        .status-loading { background: #e3f2fd; color: #1565c0; }
        .status-success { background: #e8f5e9; color: #2e7d32; }
        .status-error { background: #ffebee; color: #c62828; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ å…¨è‡ªåŠ¨åˆ†äº«</h1>
        <p style="color: #666; margin: 10px 0 30px;">é€‰æ‹©å¹³å°ï¼Œè‡ªåŠ¨è¿›å…¥å‘å¸ƒé¡µé¢</p>
        
        <button class="share-btn" id="btn-douyin" onclick="shareToDouyin()">
            ğŸ“¹ åˆ†äº«åˆ°æŠ–éŸ³
        </button>
        
        <button class="share-btn" id="btn-kuaishou" onclick="shareToKuaishou()">
            âš¡ åˆ†äº«åˆ°å¿«æ‰‹
        </button>

        <div id="status" class="status-box">
            <p id="status-text"></p>
        </div>
    </div>

    <script>
        // ==================== é…ç½®ä¿¡æ¯ ====================
        const CONFIG = {
            douyin: {
                videoUrl: "https://v95-web-sz.douyinvod.com/88254fe929fc8ac62df2e8760f85bcba/68cc133e/video/tos/cn/tos-cn-ve-15/oQ1ArEFnuQD3ZggA1aPgfJEuofI09dLADN11sB/?your_video_params",
                prefillText: "ğŸŒˆ åˆ†äº«å¿«ä¹æ—¶åˆ»ï¼æ¯ä¸€å¤©éƒ½å€¼å¾—è¢«è®°å½•å’Œåº†ç¥ï¼ğŸ‰\n\nç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸å°±æ˜¯æœ€å¤§çš„å¹¸ç¦ï¼ğŸ’–\n\n#åˆ†äº«å¿«ä¹ #å¹¸ç¦æ—¶å…‰ #ç”Ÿæ´»è®°å½•",
                // æŠ–éŸ³å®˜æ–¹åˆ†äº«æ·±åº¦é“¾æ¥
                scheme: "snssdk1128://platformapi/startapp?start_type=share&share_type=video&video_path={videoUrl}&content={text}&auto_fill=1"
            },
            kuaishou: {
                videoUrl: "https://ä½ çš„å¿«æ‰‹è§†é¢‘ç›´é“¾.mp4",
                prefillText: "ğŸŒˆ åˆ†äº«å¿«ä¹æ—¶åˆ»ï¼æŠŠè¿™ä»½å¿«ä¹ä¼ é€’ç»™ä½ ï¼ğŸŒŸ\n\n#åˆ†äº«å¿«ä¹ #å¹¸ç¦æ—¶å…‰",
                // å¿«æ‰‹å®˜æ–¹åˆ†äº«æ·±åº¦é“¾æ¥
                scheme: "kwai://create?text={text}&video_url={videoUrl}&auto_publish=1"
            }
        };

        // ==================== æŠ–éŸ³åˆ†äº«å‡½æ•° ====================
        async function shareToDouyin() {
            showStatus('æ­£åœ¨å‡†å¤‡æŠ–éŸ³åˆ†äº«...', 'loading');
            
            try {
                const config = CONFIG.douyin;
                const shareUrl = config.scheme
                    .replace('{videoUrl}', encodeURIComponent(config.videoUrl))
                    .replace('{text}', encodeURIComponent(config.prefillText));

                // æ–¹æ³•1: ä½¿ç”¨å®˜æ–¹SDKï¼ˆå¦‚æœå¯ç”¨ï¼‰
                if (window.DouyinShare) {
                    await window.DouyinShare.share({
                        video_url: config.videoUrl,
                        text: config.prefillText,
                        success: function() {
                            showStatus('æŠ–éŸ³åˆ†äº«å·²å¯åŠ¨ï¼', 'success');
                        },
                        fail: function() {
                            // SDKå¤±è´¥ï¼Œä½¿ç”¨æ·±åº¦é“¾æ¥
                            openDeepLink(shareUrl, 'douyin');
                        }
                    });
                } else {
                    // æ–¹æ³•2: ä½¿ç”¨å¢å¼ºç‰ˆæ·±åº¦é“¾æ¥
                    openDeepLink(shareUrl, 'douyin');
                }
            } catch (error) {
                console.error('æŠ–éŸ³åˆ†äº«é”™è¯¯:', error);
                showStatus('æŠ–éŸ³åˆ†äº«å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ–¹æ¡ˆ...', 'error');
                setTimeout(() => openDeepLink(CONFIG.douyin.scheme, 'douyin'), 1000);
            }
        }

        // ==================== å¿«æ‰‹åˆ†äº«å‡½æ•° ====================
        function shareToKuaishou() {
            showStatus('æ­£åœ¨å‡†å¤‡å¿«æ‰‹åˆ†äº«...', 'loading');
            
            const config = CONFIG.kuaishou;
            const shareUrl = config.scheme
                .replace('{videoUrl}', encodeURIComponent(config.videoUrl))
                .replace('{text}', encodeURIComponent(config.prefillText));
            
            openDeepLink(shareUrl, 'kuaishou');
        }

        // ==================== å¢å¼ºç‰ˆæ·±åº¦é“¾æ¥æ‰“å¼€ ====================
        function openDeepLink(url, platform) {
            console.log(`æ‰“å¼€${platform}æ·±åº¦é“¾æ¥:`, url);
            
            // è®°å½•å¼€å§‹æ—¶é—´
            const startTime = Date.now();
            
            // æ–¹æ³•1: ç›´æ¥è·³è½¬
            window.location.href = url;
            
            // æ–¹æ³•2: å®šæ—¶æ£€æŸ¥æ˜¯å¦è·³è½¬æˆåŠŸ
            setTimeout(() => {
                if (Date.now() - startTime > 500 && !document.hidden) {
                    // è·³è½¬å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ–¹æ¡ˆ
                    showStatus(`è‡ªåŠ¨è·³è½¬å¤±è´¥ï¼Œå°è¯•å…¶ä»–æ–¹å¼...`, 'error');
                    tryAlternativeMethods(platform);
                } else {
                    showStatus(`è·³è½¬æˆåŠŸï¼æ­£åœ¨æ‰“å¼€${platform}...`, 'success');
                }
            }, 300);
            
            // æ–¹æ³•3: ä½¿ç”¨iframeä½œä¸ºå¤‡ç”¨ï¼ˆé’ˆå¯¹iOSï¼‰
            setTimeout(() => {
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = url;
                document.body.appendChild(iframe);
                setTimeout(() => document.body.removeChild(iframe), 1000);
            }, 100);
        }

        // ==================== å¤‡ç”¨æ–¹æ¡ˆ ====================
        function tryAlternativeMethods(platform) {
            const config = CONFIG[platform];
            const alternatives = [
                `snssdk1128://create?text=${encodeURIComponent(config.prefillText)}`,
                `kwai://create?text=${encodeURIComponent(config.prefillText)}`,
                `douyin://create?text=${encodeURIComponent(config.prefillText)}`
            ];
            
            // å°è¯•æ‰€æœ‰å¤‡ç”¨æ–¹æ¡ˆ
            alternatives.forEach((scheme, index) => {
                setTimeout(() => {
                    window.location.href = scheme;
                }, index * 500);
            });
            
            // æœ€ç»ˆå¤‡ç”¨æ–¹æ¡ˆ
            setTimeout(() => {
                showStatus(`è¯·æ‰‹åŠ¨æ‰“å¼€${platform}å®Œæˆåˆ†äº«`, 'error');
            }, 2000);
        }

        // ==================== è¾…åŠ©å‡½æ•° ====================
        function showStatus(message, type) {
            const statusBox = document.getElementById('status');
            const statusText = document.getElementById('status-text');
            
            statusText.textContent = message;
            statusBox.className = `status-box status-${type}`;
            statusBox.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => statusBox.style.display = 'none', 3000);
            }
        }

        // é¡µé¢å¯è§æ€§æ£€æµ‹
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                showStatus('è·³è½¬æˆåŠŸï¼è¯·åœ¨Appä¸­å®Œæˆå‘å¸ƒ', 'success');
            }
        });

        console.log('å…¨è‡ªåŠ¨åˆ†äº«ç³»ç»Ÿå·²å°±ç»ª');
    </script>
</body>
</html>
